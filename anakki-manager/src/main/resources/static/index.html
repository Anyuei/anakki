<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description"
          content="anakki站">
    <meta name="anakki" content="x">
    <title>Anakki-World</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700,800|Roboto:400,500,700" rel="stylesheet">
    <!-- Theme CSS -->
    <link type="text/css" href="assets/css/theme.css" rel="stylesheet">
    <!-- Demo CSS - No need to use these in your project -->
    <link type="text/css" href="assets/css/demo.css" rel="stylesheet">
    <!--    icon-->
    <!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">-->
    <!--    <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap-icons/1.10.0/bootstrap-icons.min.css">-->
</head>
<style>
    .modal {
        display: none;
        height: auto;
        top: 0px;
        position: fixed;
        right: 0px;
        width: 100%;
        vertical-align: middle;
        z-index: 9999;
        background-color: rgba(0, 0, 0, 0);
    }

    .modal-image {
        display: block;
        max-width: 90%;
        max-height: 90%;
        margin: auto;
        margin-top: 5%;
    }

    .windows-bottom {
        position: fixed;
        right: 0px;
        bottom: 0px;
        background: #000;
        color: #fff;
        display: block;
        width: 100%;
        text-align: right;
        filter: alpha(opacity=70); /* IE */
        opacity: .7; /* 支持CSS3的浏览器（FF 1.5也支持）*/
        font-weight: bold;
    }
</style>
<body>
<!--通用顶部导航-->
<div id="header"></div>
<main class="main">
    <section class="spotlight parallax bg-cover bg-size--cover" data-spotlight="fullscreen"
             style="background-image: url('https://securex-1258150206.cos.ap-beijing.myqcloud.com/backend/DSC06473.jpg')">
        <div class="spotlight-holder pt-lg-xl py-lg-xl">
            <div class="container d-flex align-items-top no-padding">
                <div class="col">
                    <div class="row cols-xs-space align-items-center text-center text-md-left justify-content-center">
                        <div class="col-7">
                            <div class="text-center mt-5">
                                <img src="assets/images/brand/icon.png" style="width: 20%;" class="img-fluid animated"
                                     data-animation-in="jackInTheBox" data-animation-delay="1000">
                                <h2 class="heading font-weight-400 text-white mt-5 animated"
                                    data-animation-in="fadeInUp" data-animation-delay="2000">
                                    <span class="font-weight-700">ANAKKI</span> X
                                </h2>
                                <p class="lead text-white mt-3 lh-180 c-white animated" data-animation-in="fadeInUp"
                                   data-animation-delay="2500">
                                    <strong class="text-white">

                                    </strong>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <hr>
    <section class="slice">
        <div class="container-lg">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <!-- Typography -->
<!--                    <div class="row align-items-center mb-5">-->
<!--                        <div class="col-6">-->
<!--                            <h2 class="heading h3 mb-0">川藏线骑行</h2>-->
<!--                        </div>-->
<!--                        <div class="col-6  text-right">-->
<!--                            <h2 class="heading h3 mb-0">2022年</h2>-->
<!--                        </div>-->
<!--                    </div>-->
                    <div class="row typeface-palette cols-xs-space cols-sm-space cols-md-space" id="mainFlow">
                        <!--主要图文-->
                        <div class="spinner-border m-5" role="status">
                            <span class="visually-hidden">传输中...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
<!-- 页面底部 -->
<div id="footer"></div>
<!-- Core -->
<script src="assets/vendor/jquery/jquery.min.js"></script>
<script src="assets/vendor/popper/popper.min.js"></script>
<script src="assets/js/bootstrap/bootstrap.min.js"></script>
<!-- FontAwesome 5 -->
<script src="assets/vendor/fontawesome/js/fontawesome-all.min.js" defer></script>
<!-- Page plugins -->
<script src="assets/vendor/bootstrap-select/js/bootstrap-select.min.js"></script>
<script src="assets/vendor/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
<script src="assets/vendor/input-mask/input-mask.min.js"></script>
<script src="assets/vendor/nouislider/js/nouislider.min.js"></script>
<script src="assets/vendor/textarea-autosize/textarea-autosize.min.js"></script>

<!-- Theme JS -->
<script src="assets/js/theme.js"></script>
<script>

    window.onload = function () {
        $('#header').load("../pages/header.html", loadPersonDetail);
        $('#footer').load("../pages/footer.html", insertCreateTime);

        var mainPageImageFlow = new XMLHttpRequest();
        mainPageImageFlow.open("GET", "/base/anakki/record/flow?imageType=MAINPAGE_FLOW", true);
        mainPageImageFlow.onreadystatechange = function () {
            if (mainPageImageFlow.readyState === 4 && mainPageImageFlow.status === 200) {
                var html = "";
                var response = JSON.parse(mainPageImageFlow.responseText);
                var itemList = response.data.data;
                for (let i = 0; i < itemList.length; i++) {
                    var item = itemList[i];

                    var dateTime = new Date(item.photoTime);
                    var year = dateTime.getFullYear();
                    var month = dateTime.getMonth() + 1; // Months are zero-based, so we add 1
                    var day = dateTime.getDate();
                    var formattedDate = year + "-" + month + "-" + day;

                    var fileSize=item.fileSize;
                    var fileSizeDisplay = fileSize >= 1024 ? (fileSize / 1024).toFixed(2) + " MB" : fileSize + " KB";
                    html +=
                        "<div class='col-lg-4'>" +
                            "<figure class='figure'>" +
                                "<img src='" + item.imgUrl + "' class=\"figure-img img-fluid rounded\" alt=\"" + item.id + "\" onclick=\"showModal(this)\">" +
                                "<figcaption class='figure-caption'>" +
                                    "<strong>" +
                                        item.title + " - " + item.location + "<i class='fas fa-eye'></i> " + item.viewCount +
                                "</strong> " +
                                "</figcaption>" +
                                " <figcaption class='figure-caption'>" +
                                    formattedDate +
                                " </figcaption>" +
                                "<p class=\"card-text\">" +
                                "<small class=\"text-muted\">图片尺寸: " +
                                    item.imageSize + "| 大小: "+fileSizeDisplay+
                                "</small>" +
                                "</p>\n" +
                            " </figure>" +
                        " </div>";
                }
                document.getElementById("mainFlow").innerHTML = html;
            }
        };
        mainPageImageFlow.send();
    };

    function showModal(image) {

        var get = new XMLHttpRequest();
        get.open("GET", "/base/anakki/record/flowById?id=" + image.alt, true);
        get.onreadystatechange = function () {
            if (get.readyState === 4 && get.status === 200) {
                var response = JSON.parse(get.responseText);
                var item = response.data;

                var dateTime = new Date(item.photoTime);
                var year = dateTime.getFullYear();
                var month = dateTime.getMonth() + 1; // Months are zero-based, so we add 1
                var day = dateTime.getDate();
                var formattedDate = year + "-" + month + "-" + day;
                var fileSize=item.fileSize;
                var fileSizeDisplay = fileSize >= 1024 ? (fileSize / 1024).toFixed(2) + " MB" : fileSize + " KB";
                var html =
                    "<div class=\"\">\n" +
                        "<img src=\"" + item.imgUrl + "\" class=\"card-img-top\" alt=\"...\">\n" +
                    "</div>" +
                    "<div class=\"card-body windows-bottom\">\n" +
                        "<h5 class=\"card-title\">" +
                            item.title + "<i class='fas fa-eye'></i> " + item.viewCount +
                        "</h5>\n" +
                        "<p class=\"card-text\">" +
                            item.description +
                        "<p class=\"card-text\">" +
                            "<small class=\"text-muted\">" +
                                formattedDate +
                            "</small>" +
                        "</p>\n" +
                        "<p class=\"card-text\">" +
                            "<small class=\"text-muted\">图片尺寸: " +
                                item.imageSize + "| 大小: "+fileSizeDisplay+
                            "</small>" +
                        "</p>\n" +
                    "</div>\n"
                ;
                // Create a modal element
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style = "display:block";
                modal.style.display = 'flex';
                modal.style.justifyContent = 'center';
                modal.style.alignItems = 'center';
                // Create an image element for the full-screen view
                const fullScreenImage = document.createElement('img');
                fullScreenImage.src = image.src;
                fullScreenImage.className = 'modal-image';
                // Add the image to the modal
                modal.appendChild(fullScreenImage);
                // Add the modal to the document body
                document.body.appendChild(modal);
                // Close the modal when clicked outside the image
                modal.addEventListener('click', function (event) {
                    modal.remove();
                });
                modal.innerHTML = html;
            }
        };
        get.send();
    }

    function hideModal() {
        var modal = document.getElementById("modal");
        modal.style.display = "none";
    }
</script>
</body>
</html>
